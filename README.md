# Project_Messiah
온라인 실시간 타일형 배틀 웹게임

Project_Messiah는 socket.io 기반 WebSocket 통신을 활용한 온라인 실시간 타일형 배틀 웹게임입니다.

총 5명이 참여한 프로젝트에서 주 개발자(서버)로서 게임 시스템 설계, 핵심 기능 구현, 서버 구축 및 실제 서비스 운영 전반을 담당했습니다.

---

## 개발 및 운영 기간

- 개발 기간: 2025.08 ~ 2025.10 (약 2개월)
- 운영 기간: 2025.10 ~ 2025.11 (약 1개월)

약 1개월간 실제 사용자를 대상으로 서비스를 운영하며, 플레이 로그와 사용자 피드백을 기반으로 기능을 점진적으로 추가·개선했습니다.

---

## 역할 및 책임

- 프로젝트 참여 인원: 총 5명 (기획 1, 아트 2, 개발 2)
- 개발 역할: 주 개발자(서버) 및 테스트

담당 업무
- 게임 초기 시스템 아키텍처 설계
- 실시간 통신 기반 게임 로직 구현
- 서버 환경 구축 및 배포
- 서비스 운영 및 장애 대응

---

## 프로젝트 개요

- 로그인 후 하나의 월드 맵에 접속하여 8방향 이동 기반 탐색
- 맵 내 오브젝트 및 NPC와 상호작용 (대화, 퀘스트 이벤트 수락)
- 실시간 전투는 타일 기반 배틀 룸에서 진행
- WebSocket을 활용해 이동, 행동, 전투 상태를 실시간 동기화

---

## 서버 및 인프라 구성

- AWS EC2 기반 서비스 배포
- Ubuntu 22.04 환경 서버 직접 구성
- Nginx 웹 서버 설정
- 도메인 구매 및 연결
- CORS 이슈 해결
- PM2 기반 Node.js 프로세스 관리
- MySQL 사용
- 운영 로그 관리 및 서버 상태 모니터링

---

## 사용 기술

### Server
- Node.js
- socket.io (WebSocket 기반 실시간 통신)
- PHP
- AWS EC2
- PM2
- MySQL

### Frontend
- HTML
- CSS
- Vanilla JavaScript

### 기타
- 코드 에이전트(AI) 활용
  - 구조 설명 후 코드 초안 생성
  - 직접 검토 및 수정 방식으로 개발 속도 개선

---

## 월드 탐색 및 캐릭터 동작 구조

- 사용자는 방향키를 통해 맵을 탐색
- 충돌 판정(Collision)은 로컬에서 처리
- 최초 접속 시
  - 서버에서 DB에 저장된 캐릭터 최종 위치 및 상태 정보 로드
  - 해당 위치 기준으로 필요한 맵 정보 및 이미지 리소스 전달
- 클라이언트는 전달받은 데이터를 기반으로 페이지 렌더링 및 캐릭터 객체 생성
- 이동 중 일정 주기로 서버에 현재 위치 정보 전송
- 소켓 연결 종료 시
  - 캐릭터 최종 위치를 DB에 저장하여 재접속 시 동일 위치로 복구

---

## 실시간 타일형 배틀 시스템

- 전투는 글로벌 파티 단위로 참여 가능
- 캐릭터는 1명당 1타일을 점유
- 이동 불가 타일 존재

### 플레이어

- 총 4개의 스킬 보유
- 스킬 유형
  - 이동 스킬
  - 공격 스킬
  - 자기 버프 / 디버프
- 모든 스킬은 범위, 형태, 쿨다운, 크기, 데미지 계수 등
  다양한 파라미터를 가짐
- AP / MP / HP 시스템
  - AP와 MP가 충분해야 스킬 사용 가능
  - 스킬별 소모 자원 상이

### 적

- 개체별로 이미지, 스탯, 스킬이 모두 다름
- 패턴 구성
  - 시간 조건 기반 강제 패턴
  - HP 조건 기반 패턴 (페이즈 전환)
  - 특정 HP 구간 전용 스킬
  - 일정 주기 랜덤 패턴
- 적 스킬은 클라이언트에 붉은 장판으로 사전 표시
  - 범위 밖: 0 데미지
  - 범위 내: 데미지 적용

### 스킬 처리 방식

- 대부분의 스킬은 범위형 스킬
- 스킬 발동 시
  1. 서버에서 범위 계산
  2. 해당 범위를 룸 내 클라이언트에 전파
  3. 클라이언트에서 시각적 표시 렌더링
  4. 설정된 n초 후 서버에서
     범위 내 캐릭터 판별 및 데미지 적용

---

## 서버 전투 관리 구조

- 모든 전투를 관리하는 중앙 tick
  - 배틀 시작
  - 배틀 종료
  - 종료 조건 검증
  - 전투 상태 관리
- 캐릭터의 이동 및 행동 발생 시마다 서버에서 상태를 업데이트하여 서버 권한 기반 게임 구조 유지

---

## 채팅 시스템

- 맵 단위 채팅 채널 분리
- 동일 맵에 위치한 사용자끼리만 채팅 가능

---


## 운영 중 추가·개선 사항

### 1. 게임 데이터 관리 구조 개선
- 프론트엔드 JSON 직접 로드 방식의 보안 취약점 확인
- 서버 검증 방식으로 구조 변경
- 보상 및 결과는 서버에서만 확정
- 보안성 및 데이터 신뢰도 개선
- NoSQL(JSON) 방식 데이터 관리 경험

### 2. 몬스터 전투 패턴 확장
- 신규 패턴 추가
  - 전체 타겟 공격
  - 버프 / 디버프
  - 함정 타일
  - 몬스터 도발
- 강제 패턴과 랜덤 패턴 병행
- HP 기반 페이즈 전환 구현

### 3. UI/UX 개선
- 캐릭터 외곽선 추가로 시인성 개선
- 데미지 유형별 로그 색상 분리

### 4. 콘텐츠 확장
- 퀘스트 및 이벤트 시스템 추가
- NPC 및 오브젝트 상호작용
- 보상 교환 시스템 구현

### 5. 서버 재시작 시 위치 동기화 개선
- 종료 직전 캐릭터 위치 저장
- 재시작 후 동일 위치 복구

### 6. 운영자 전용 게임 관람 기능
- 실시간 진행 중인 게임 관람 기능 추가
- 밸런스 및 플레이 패턴 분석 목적
- 운영자 계정만 접근 가능
- 읽기 전용 상태 수신

---

## 이후 고려 중인 개선 사항

- Redis 도입 검토
- 스크립트 및 보상 데이터 DB화
- 배틀 객체 책임 단위 분리 및 구조 개선
